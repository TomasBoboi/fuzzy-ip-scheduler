\documentclass[12pt]{article}

\usepackage[a4paper, margin=1in]{geometry}
\usepackage{hyperref}
\usepackage{graphicx}
\usepackage{enumitem}
\usepackage{amsmath}

\title{OMNeT++ Fuzzy IP Scheduler\\\large{Overview, implementation, and analysis}}
\date{2021\\March}
\author{\\Tomas-Adrian Boboi\\Universitatea Politehnica TimiÈ™oara}

\begin{document}
    \maketitle
    \pagebreak
    
    \tableofcontents
    \pagebreak
    
    \section{Original assignment requirements}
        \subsection*{The simulation model}
            The simulation model consists of the following OMNeT++ modules:
            \begin{enumerate}
                \item{A number of mobile users. In the first stages of the model you can implement two identical users, then you can consider a number of K users, organized as an array of users. Each user generates IP packets according to a certain pattern: e.g. an IP packet at certain (random) time intervals, or a user generates files, a file consisting on a (random) number of IP packets. At the beginning the IP packets can be considered of fixed length, i.e. one IP packet = 1500 bytes. A user has a certain priority. There can be for example 3 or 4 priority levels. For 3 priority levels, they are (in increasing order): LP (low priority), medium priority (MP) and HP (high priority). For 4 levels, they are: non real-time (nrt) low priority and nrt HP, real-time (rt) LP and rt HP.}
                \item{A scheduler. The scheduler is situated in the same Omnet module as the queues. The queues are not per user, but per priority class. This means that the packets arriving from LP user will be stored in the LP queue, the packets from MP and respectively HP users will be stored in the MP and respectively HP queue. The scheduler reads the lengths of the queues and implements a scheduling algorithm that determines which queue will send data. The sending of a packet takes a time equal to its length divided by the line rate (i.e. 1500 bytes / 1 Mega bit per second). The scheduler cannot send another packet during this time interval.}
                \item{A sink. The sink models the destination of the data. When the data (i.e. IP) packets created by an user arrive to the sink module, the sink simply deletes the OMNeT++ messages representing the data packets. Also, the sink is used to collect statistics about the simulation, statistics that can be for each user, for each group of users (e.g. Low, Medium and High priority users) and/or for the entire system. These statistical information can be: the number of data packets that arrive to the sink, the mean, minimum and maximum delay of the data packets, etc.}
            \end{enumerate}
            In the OMNeT directories there is one called "samples", with different simulation models implemented in OMNeT++. From these samples, you can use as a starting point for your model the sources from the "fifo" system.
        
        \subsection*{Basic/minimal requirements}
            Implement the simulation model described above. The scheduling algorithm is not very important in this stage, it can be a simple round robin: each nonempty queue sends a data packet. Or it can be a priority queueing algorithm: a queue is not served until there are non-empty higher priority queues.

        \subsection*{For exam, there are two alternatives to improve the project}
            Implement one of the following scheduling algorithms:
            \begin{itemize}
                \item{Priority queueing (a lower priority queue is served if and only if all higher priority queues are empty)}
                \item{A weighted round robin: an action takes place every time when there are resources available. The winner of the action will be served. The criteria for the action is, firstly, the time elapsed since the user was served last time. Then, we can improve the algorithm by introducing weights (positive numbers >1). The time elapsed since the user was served last time is multiplied with user's weight. Then, a user with a higher weight will be served more often. Compare the performance (i.e. average delay, minimum and maximum delay) of the implemented algorithms.}
            \end{itemize}
    
        \subsection*{New requirements (addition of the \textit{fuzzy logic controller})}
            Use a fuzzy logic controller in order to adjust the weight of HP users (W\_HP) such that their average delay will be most of the time smaller than a certain value.
            
            If the scheduling algorithm is priority queueing (PQ), then we cannot apply fuzzy weight adaptation like above, since PQ does not use weights!

    \section{Network structure}
    The network is described by the \verb|IpScheduler.ned| file, which contains the users, which generate the IP packets, the packet handler, which handles the packets received from the users, and the sink, which receives the packets sent from the packet handler.

        \subsection{IpScheduler}
            \verb|IpScheduler| is the main network, where all the sub-components reside.
            \begin{figure}[htbp!]
                \centering
                \includegraphics[width=0.8\textwidth]{images/ip_scheduler.png}
                \caption{The main network structure}
            \end{figure}
        
        \subsection{PacketHandler}
            \verb|PacketHandler| is the component responsible with receiving the packets from the users, storing them in the corresponding queue, depending on the priority level of the users, scheduling the sending of the packets, and sending the packets to the sink.
            \begin{figure}[htbp!]
                \centering
                \includegraphics[width=0.45\textwidth]{images/packet_handler.png}
                \caption{The packet handler structure}
            \end{figure}
        
        \subsection{User}
            The \verb|User| is the component which generates IP packets at a certain rate, and sends them to be handled bu the \verb|PacketHandler|. The users are grouped in priority classes:
            \begin{itemize}
                \item{non-real-time, low priority (nrtLp)}
                \item{non-real-time, low priority (nrtHp)}
                \item{real-time, high priority (rtLp)}
                \item{real-time, low priority (rtHp)}
            \end{itemize}
            The size of the generated IP packets, the packet generation rate, and the number of users in each priority class can be configured in the \verb|ipsched/config/users.ini| and \verb|ipsched/config/user_packets.ini| files.

        \subsection{Queue}
            The \verb|Queue| is the module which stores the IP packets generated by the users, and sends them towards the sink, whenever the scheduler allows it. There are four queues, one for each priority class, and they all communicate with the scheduler bidirectionally: they receive control messages from the scheduler, and send packets to the scheduler, when asked to.
            The \textit{Queue} class contains a \verb|cPacketQueue| attribute, where the IP packets are stored.
            The \verb|Queue| module is also responsible with logging each queue's length, so we can collect data about the length of each queue at any given time.
        
        \subsection{Sink}
            The \verb|Sink| is a module whose only purpose is to receive the IP packets, delete them, and record statistics about them (packet lifetime, total number of packets, etc.).

        \subsection{Scheduler}
            The \verb|Scheduler| can be considered the most complex module of the system, and the most important, because it is responsible for deciding which queue sends a packet towards the sink. This job can be accomplished in multiple ways, and the current project provides two scheduler implementations: Weighted Round Robin, with and without the addition of the \textit{fuzzy logic controller}.

    \section{The fuzzy logic controller}
        \subsection{The \textit{FLC} module}
            Asdf
        
        \subsection{The \textit{FLC\_gen} module}
            Asdf
    
    \section{Experiments}
        \subsection{Simulation parameters}
            Asdf
        
        \subsection{Standalone experiments}
            Asdf
        
        \subsection{Comparative experiments}
            Asdf

    \pagebreak
    \section{References}
    \begin{enumerate}[label=(\arabic*)]
        \item{\verb|http://staff.cs.upt.ro/~todinca/cad/IP_scheduling.html|}
        \item{\verb|http://staff.cs.upt.ro/~todinca/TPAC/tpac.html|}
        \item{\verb|https://doc.omnetpp.org/omnetpp/manual/|}
        \item{\verb|https://docs.omnetpp.org/tutorials/tictoc/|}
        \item{\verb|https://doc.omnetpp.org/omnetpp/api/|}
    \end{enumerate}
\end{document}